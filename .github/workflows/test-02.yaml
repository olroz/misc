name: Learning Workflow (Advanced)

on:
  #push:
  pull_request:
  workflow_dispatch:

jobs:
  setup:
    name: Setup Environment
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        run: echo "Checking out code..."

      - name: Initialize environment
        run: echo "Setting up environment variables, tools, etc."

  # Two jobs that run in parallel (no 'needs')
  lint:
    name: Lint Code
    runs-on: ubuntu-latest
    steps:
      - name: Run linter
        run: echo "Running code linting..."

  security:
    name: Security Scan
    runs-on: ubuntu-latest
    steps:
      - name: Run security scan
        run: echo "Scanning for vulnerabilities..."

  # Depends on setup + both parallel jobs
  build:
    name: Build Project
    runs-on: ubuntu-latest
    needs: [setup, lint, security]
    steps:
      - name: Prepare build
        run: echo "Preparing build directory..."

      - name: Build artifacts
        run: echo "Building the project..."

  test:
    name: Run Tests
    runs-on: ubuntu-latest
    needs: build
    steps:
      - name: Run unit tests
        run: echo "Running tests..."

      - name: Upload results
        run: echo "Uploading test results..."

  deploy:
    name: Deploy Application
    runs-on: ubuntu-latest
    needs: test
    if: github.ref == 'refs/heads/master'  # only run on main branch
    steps:
      - name: Deploy to production
        run: echo "Deploying to production (main branch only)..."

      - name: Post-deploy validation
        run: echo "Running post-deployment checks..."
